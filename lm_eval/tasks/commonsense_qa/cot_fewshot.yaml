task: commonsense_qa_cot_fewshot
dataset_path: tau/commonsense_qa
training_split: train
validation_split: validation
output_type: generate_until
num_fewshot: 7
fewshot_config:
  sampler: first_n
  samples:
    - question: 'What do people use to absorb extra ink from a fountain pen?'
      choices:
        text:
          - shirt pocket
          - calligrapherâ€™s hand
          - inkwell
          - desk drawer
          - blotter
      answerKey: 'The answer must be an item that can absorb ink. Of the above choices, only blotters are used to absorb ink. So the answer is (e).'

    - question: 'What home entertainment equipment requires cable?'
      choices:
        text:
          - radio shack
          - substation
          - television
          - cabinet
      answerKey: 'The answer must require cable. Of the above choices, only television requires cable. So the answer is (c).'

    - question: 'The fox walked from the city into the forest, what was it looking for?'
      choices:
        text:
            - pretty flowers
            - hen house
            - natural habitat
            - storybook
      answerKey: 'The answer must be something in the forest. Of the above choices, only natural habitat is in the forest. So the answer is (b).'

    - question: 'Sammy wanted to go to where the people were. Where might he go?'
      choices:
        text:
          - populated areas
          - race track
          - desert
          - apartment
          - roadblock
      answerKey: 'The answer must be a place with a lot of people. Of the above choices, only populated areas have a lot of people. So the answer is (a).'

    - question: 'Where do you put your grapes just before checking out?'
      choices:
        text:
          - mouth
          - grocery cart
          - supermarket
          - fruit basket
          - fruit market
      answerKey: 'The answer should be the place where grocery items are placed before checking out. Of the above choices, grocery cart makes the most sense for holding grocery items. So the answer is (b).'

    - question: 'Google Maps and other highway and street GPS services have replaced what?'
      choices:
        text:
          - united states
          - mexico
          - countryside
          - atlas
      answerKey: 'The answer must be something that used to do what Google Maps and GPS services do, which is to give directions. Of the above choices, only atlases are used to give directions. So the answer is (d).'

    - question: 'Before getting a divorce, what did the wife feel who was doing all the work?'
      choices:
        text:
          - harder
          - anguish
          - bitterness
          - tears
          - sadness
      answerKey: 'The answer should be the feeling of someone getting divorced who was doing all the work. Of the above choices, the closest feeling is bitterness. So the answer is (c).'

    # this 8th question is included to prevent FirstNSampler from throwing an error when it tries to sample num_fewshot + 1 examples
    # note that this occurs because the fewshot_split is None == test_split which is None so it tries to draw num_fewshot + 1 examples
    - question: 'SHOULD NEVER BE SELECTED'
      choices:
        text:
          - 'SHOULD NEVER BE SELECTED'
      answerKey: 'SHOULD NEVER BE SELECTED'

doc_to_text: !function utils.doc_to_text
doc_to_target: answerKey
generation_kwargs:
  until:
    - "</s>"
    - "Q"
    - "\n\n"
  do_sample: false
  temperature: 0.0
filter_list:
  - name: "get-answer"
    filter:
      - function: "regex"
        regex_pattern: "(?<=the answer is )(.*)(?=.)"
      - function: "take_first"
metric_list:
  - metric: exact_match
    aggregation: mean
    higher_is_better: true
    ignore_case: true
    ignore_punctuation: true
